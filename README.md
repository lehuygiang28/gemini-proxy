# Gemini Proxy

**Gemini Proxy** is a powerful, open-source toolkit for managing and proxying requests to Google's Gemini API. It provides a robust set of features for developers and organizations to monitor, control, and scale their usage of the Gemini API.

## üìã Table of Contents

<details>
<summary><strong>üöÄ Quick Start</strong></summary>

- [Introduction](#-introduction)
- [Core Features](#-core-features)
- [Prerequisites](#-prerequisites)
- [Quick Start Guide](#-quick-start-guide)

</details>

<details>
<summary><strong>‚öôÔ∏è Configuration</strong></summary>

- [Environment Variables](#Ô∏è-environment-variables)
- [API Endpoints](#-api-endpoints)
- [Usage Examples](#-usage-examples)

</details>

<details>
<summary><strong>üåê Platform Support</strong></summary>

- [Deployment Options](#-deployment-options)
- [Platform-Specific Guides](#Ô∏è-platform-specific-guides)

</details>

<details>
<summary><strong>üîß Technical Details</strong></summary>

- [Architecture](#Ô∏è-architecture)
- [Project Structure](#-project-structure)
- [Development](#Ô∏è-development)

</details>

<details>
<summary><strong>üìö References</strong></summary>

- [Contributing](#-contributing)
- [License](#-license)

</details>

## üöÄ Introduction

Gemini Proxy is a comprehensive solution that allows you to:

- **üîë Manage API Keys:** Securely store and rotate multiple Google Gemini API keys
- **‚ö° Load Balance:** Distribute requests across multiple API keys for optimal performance
- **üìä Monitor Usage:** Track API usage, costs, and performance metrics
- **üõ°Ô∏è Control Access:** Manage proxy keys and access permissions
- **üìù Log Requests:** Detailed logging of all API requests and responses
- **üåç Deploy Anywhere:** Support for multiple deployment platforms

## ‚ú® Core Features

### üîë **API Key Management**

- Secure storage of multiple Google Gemini API keys
- Intelligent key rotation and load balancing
- Usage tracking and analytics per key
- Enable/disable keys without downtime

### ‚ö° **Performance & Scalability**

- Automatic request distribution across API keys
- Built-in retry mechanisms with exponential backoff
- Request caching and optimization
- Support for streaming responses

### üìä **Monitoring & Analytics**

- Real-time request logging and analytics
- Performance metrics and cost tracking
- Error monitoring and alerting
- Usage dashboards and reports

### üõ°Ô∏è **Security & Access Control**

- Proxy API key management
- Request authentication and authorization
- Rate limiting and abuse prevention
- Secure environment variable handling

### üåç **Multi-Platform Support**

- **Next.js Fullstack App** (Recommended)
- **Standalone Node.js API Server**
- **Vercel Edge Functions**
- **Cloudflare Workers**
- **Appwrite Functions**

## üìã Prerequisites

Before you begin, ensure you have the following installed:

### **Required Software**

- **Node.js** (v18 or higher)
- **pnpm** (v8 or higher)
- **Git**

### **Required Accounts**

- **Google AI Studio** account for Gemini API keys
- **Supabase** account for database and authentication

### **Installation Commands**

```bash
# Install Node.js (if not already installed)
# Download from: https://nodejs.org/

# Install pnpm
npm install -g pnpm

# Verify installations
node --version
pnpm --version
```

## üöÄ Quick Start Guide

### **Recommended: Deploy the Web App (Fastest)**

The fastest way to get started is deploying the Next.js web application:

```bash
# 1. Clone the repository
git clone https://github.com/lehuygiang28/gemini-proxy.git
cd gemini-proxy

# 2. Install dependencies
pnpm install

# 3. Configure environment
cp apps/web/.env.example apps/web/.env.local
# Edit apps/web/.env.development with your values

# 4. Start development server
cd apps/web
pnpm dev

# 5. Open the application
# http://localhost:4040
```

### **Alternative: Deploy to Vercel (Recommended for Production)**

[![Deploy with Vercel](https://vercel.com/button)](https://vercel.com/new/clone?repository-url=https%3A%2F%2Fgithub.com%2Flehuygiang28%2Fgemini-proxy&project-name=gemini-proxy&repository-name=gemini-proxy&root-directory=apps/web&build-command=pnpm%20build%20-F%20web&output-directory=apps/web/.next&env=SUPABASE_URL,SUPABASE_SERVICE_ROLE_KEY)

**Manual Setup:**

1. **Fork or clone the repository**
2. **Connect to Vercel:**
   - Go to [Vercel Dashboard](https://vercel.com/dashboard)
   - Import your GitHub repository
   - **Do NOT set root directory** (leave as default)
3. **Configure Build Settings:**
   - **Build Command:** `pnpm build -F web`
   - **Output Directory:** `apps/web/.next`
4. **Configure Environment Variables:**
   - `SUPABASE_URL` - Your Supabase project URL
   - `SUPABASE_SERVICE_ROLE_KEY` - Your Supabase service role key
5. **Deploy automatically on every push**

## ‚öôÔ∏è Environment Variables

### **Required Environment Variables**

| Variable | Description | Example |
|----------|-------------|---------|
| `SUPABASE_URL` | Your Supabase project URL | `https://your-project.supabase.co` |
| `SUPABASE_SERVICE_ROLE_KEY` | Your Supabase service role key | `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...` |

### **Optional Environment Variables**

| Variable | Description | Default | Example |
|----------|-------------|---------|---------|
| `GOOGLE_GEMINI_API_BASE_URL` | Gemini API base URL | `https://generativelanguage.googleapis.com/` | `https://generativelanguage.googleapis.com/` |
| `GOOGLE_OPENAI_API_BASE_URL` | OpenAI-compatible API base URL | `https://generativelanguage.googleapis.com/v1beta/openai/` | `https://generativelanguage.googleapis.com/v1beta/openai/` |
| `PROXY_MAX_RETRIES` | Maximum retry attempts | `-1` | `5` |
| `PROXY_LOGGING_ENABLED` | Enable request logging | `true` | `false` |
| `PROXY_LOG_LEVEL` | Logging level | `info` | `debug` |

## üíª Usage Examples

### **Using with Google Generative AI SDK**

```typescript
import { GoogleGenAI } from '@google/genai';

const genAi = new GoogleGenAI({
    apiKey: 'your_proxy_api_key',
    httpOptions: {
        baseUrl: 'https://your-proxy-endpoint/api/gproxy/gemini',
    },
});

// Generate content
const result = await genAi.models.generateContent({
    model: 'gemini-2.0-flash',
    contents: 'Explain quantum computing in simple terms.',
});
console.log(result.text);

// Stream content
const stream = await genAi.models.generateContentStream({
    model: 'gemini-2.0-flash',
    contents: 'Write a short story about a robot.',
});
for await (const chunk of stream) {
    console.log(chunk.text);
}
```

### **Using with OpenAI-Compatible Clients**

```typescript
import OpenAI from 'openai';

const openai = new OpenAI({
    apiKey: 'your_proxy_api_key',
    baseURL: 'https://your-proxy-endpoint/api/grpoxy/openai',
});

// Chat completions
const completion = await openai.chat.completions.create({
    model: 'gemini-2.0-flash',
    messages: [
        { role: 'system', content: 'You are a helpful assistant.' },
        { role: 'user', content: 'What is the capital of France?' }
    ],
    max_tokens: 100,
    temperature: 0.7,
});
console.log(completion.choices[0].message.content);

// Text embeddings
const embedding = await openai.embeddings.create({
    model: 'text-embedding-004',
    input: 'This is a sample text for embedding.',
    encoding_format: 'float'
});
console.log(embedding.data[0].embedding);
```

### **Using with Vercel AI SDK**

```typescript
import { generateText } from 'ai';
import { createGoogleGenerativeAI } from '@ai-sdk/google';

const google = createGoogleGenerativeAI({
    apiKey: 'gproxy_test_12345',
    baseURL: 'https://your-proxy-endpoint/api/gproxy/gemini/v1beta',
});
const { text } = await generateText({
    model: google('gemini-2.5-flash'),
    system: 'You are a friendly assistant!',
    prompt: 'Why is the sky blue?',
});
console.log(text);
```

### Health Check

```bash
# Check service health
curl https://your-proxy-endpoint/health

# Expected response
{
  "status": "ok",
  "timestamp": "2024-01-15T10:30:00.000Z"
}
```

## üåê Deployment Options

### **üéØ Recommended: Next.js Web App (Full-Stack with UI)**

**Best for:** Most users, fastest deployment, full-featured dashboard

- ‚úÖ **Complete Solution:** Web interface + API proxy in one deployment
- ‚úÖ **User-Friendly Dashboard:** Built-in UI for managing API keys, proxy keys, and monitoring
- ‚úÖ **Fastest Setup:** Single deployment with all features
- ‚úÖ **Production Ready:** Enterprise-grade features with visual management

**Deploy to:** Vercel, Netlify, Railway, or any Next.js-compatible platform

### **‚ö° Standalone API Server (API-Only)**

**Best for:** API-only deployments, custom integrations, headless services

- ‚úÖ **Lightweight:** Minimal resource usage, API-only service
- ‚úÖ **Customizable:** Full control over deployment
- ‚úÖ **Scalable:** Can be deployed anywhere
- ‚ùå **No UI:** Requires CLI or external tools for management

**Deploy to:** Docker, Railway, Render, Heroku, or any Node.js platform

### **üöÄ Edge Functions (API-Only)**

**Best for:** Global performance, low latency, serverless API

- ‚úÖ **Global CDN:** Deploy to edge locations worldwide
- ‚úÖ **Low Latency:** Fastest response times
- ‚úÖ **Auto-scaling:** Handles traffic spikes automatically
- ‚ùå **No UI:** API-only service, management via CLI or external tools

**Deploy to:** Vercel Edge Functions, Cloudflare Workers

## üõ†Ô∏è Platform-Specific Guides

Choose your preferred deployment platform:

### **üéØ [Next.js Web App](./apps/web/README.md) - Full-Stack with UI**

- Complete fullstack solution with web dashboard
- **Only option with built-in UI** for managing API keys, proxy keys, and monitoring
- Recommended for most users
- Deploy to Vercel, Netlify, or any Next.js platform

### **‚ö° [Standalone API Server](./apps/api/README.md) - API-Only**

- Lightweight Node.js API server
- **No UI** - API-only service
- Deploy to Docker, Railway, Render, or any Node.js platform

### **üöÄ [Vercel Edge Functions](./packages/vercel/README.md) - API-Only**

- Serverless edge functions
- **No UI** - API-only service
- Deploy to Vercel's global network

### **üåç [Cloudflare Workers](./packages/cloudflare/README.md) - API-Only**

- Edge computing platform
- **No UI** - API-only service
- Deploy to Cloudflare's global network

### **üîß [Appwrite Functions](./packages/appwrite/README.md) - API-Only**

- Serverless functions on Appwrite
- **No UI** - API-only service
- Deploy to Appwrite cloud

### **üõ†Ô∏è [CLI Tools](./packages/cli/README.md)**

- Command-line management tools
- **Required for managing API-only deployments** (API keys, proxy keys, logs)
- Use with any API-only deployment option

## üèóÔ∏è Architecture

```md
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Your App      ‚îÇ    ‚îÇ  Gemini Proxy   ‚îÇ    ‚îÇ  Google Gemini  ‚îÇ
‚îÇ                 ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ                 ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ      API        ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                              ‚ñº
                       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                       ‚îÇ    Supabase     ‚îÇ
                       ‚îÇ   (Database)    ‚îÇ
                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Core Components

- **üîë API Key Service:** Manages and rotates Gemini API keys
- **‚ö° Proxy Service:** Routes requests to appropriate API keys
- **üìä Logger Service:** Logs all requests and responses
- **üõ°Ô∏è Auth Service:** Handles proxy key authentication
- **üìà Analytics Service:** Tracks usage and performance

## üìÅ Project Structure

```md
gemini-proxy/
‚îú‚îÄ‚îÄ apps/                          # Applications
‚îÇ   ‚îú‚îÄ‚îÄ web/                      # Next.js web application (Recommended)
‚îÇ   ‚îî‚îÄ‚îÄ api/                      # Standalone Node.js API server
‚îú‚îÄ‚îÄ packages/                      # Packages
‚îÇ   ‚îú‚îÄ‚îÄ core/                     # Core business logic
‚îÇ   ‚îú‚îÄ‚îÄ cli/                      # Command-line tools
‚îÇ   ‚îú‚îÄ‚îÄ database/                 # Database schema and types
‚îÇ   ‚îú‚îÄ‚îÄ vercel/                   # Vercel Edge Functions
‚îÇ   ‚îú‚îÄ‚îÄ cloudflare/               # Cloudflare Workers
‚îÇ   ‚îî‚îÄ‚îÄ appwrite/                 # Appwrite Functions
‚îú‚îÄ‚îÄ examples/                      # Usage examples
‚îî‚îÄ‚îÄ README.md                     # This file
```

### **Key Directories**

- **`apps/web/`** - Next.js fullstack application with dashboard
- **`apps/api/`** - Standalone Hono.js API server
- **`packages/core/`** - Shared business logic and services
- **`packages/cli/`** - Command-line management tools
- **`examples/`** - Code examples for different SDKs

## üõ†Ô∏è Development

### **Local Development**

```bash
# Clone the repository
git clone https://github.com/lehuygiang28/gemini-proxy.git
cd gemini-proxy

# Install dependencies
pnpm install

# Start development servers
pnpm dev

# Build all packages
pnpm build

# Run tests
pnpm test
```

### **Development Scripts**

```bash
# Start all development servers
pnpm dev

# Build specific package
pnpm --filter @lehuygiang28/gemini-proxy-core build

# Run CLI commands
pnpm --filter @lehuygiang28/gemini-proxy-cli start --help

# Deploy specific package
pnpm --filter @lehuygiang28/gemini-proxy-vercel deploy
```

## ü§ù Contributing

We welcome contributions! Please see our [Contributing Guide](CONTRIBUTING.md) for details.

### **How to Contribute**

1. **Fork the repository**
2. **Create a feature branch:** `git checkout -b feature/amazing-feature`
3. **Make your changes**
4. **Add tests if applicable**
5. **Commit your changes:** `git commit -m 'Add amazing feature'`
6. **Push to the branch:** `git push origin feature/amazing-feature`
7. **Open a Pull Request**

### **Development Setup**

```bash
# Install dependencies
pnpm install

# Set up environment variables
cp apps/web/.env.example apps/web/.env.development

# Start development servers
pnpm dev
```

## üìÑ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## üîó Links

- **üìñ Documentation:** [GitHub Wiki](https://github.com/lehuygiang28/gemini-proxy/wiki)
- **üêõ Issues:** [GitHub Issues](https://github.com/lehuygiang28/gemini-proxy/issues)
- **üí¨ Discussions:** [GitHub Discussions](https://github.com/lehuygiang28/gemini-proxy/discussions)
- **‚≠ê Star:** [GitHub Repository](https://github.com/lehuygiang28/gemini-proxy)

---

**Made with ‚ù§Ô∏è by the Gemini Proxy Team**
